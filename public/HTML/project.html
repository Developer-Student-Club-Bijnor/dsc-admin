<strong>
    <h2 style="font-family:fantasy">Projects</h2></strong>
<hr color=red height=20px/>
<div id="spinner" class="text-primary " role="status" style="margin-left:45%;width: 3rem; height: 3rem;">
    <span class="sr-only">Loading...</span>
</div>
<div class="row">
    <div class="col-lg-4">
        <h3>Upload Sample</h3>
        <form id="project">
            <br>
            <div class="form-group">
                <label for="project-name">Name</label>
                <input type="text" class="form-control" id="project-name" />
                <div class="invalid-feedback">
                    Please enter project name
                </div>
            </div>
            <div class="form-group">
                <label for="project-file">Project File</label>
                <input type="file" class="form-control" id="project-file" />
                <div class="invalid-feedback">
                    Please choose valid file
                </div>
            </div>
            <div class="form-group">
                <div class="progress">
                    <div id="project-progress" class="progress-bar" style="width:0%">0%</div>
                </div>
            </div>
            <div class="form-group">
                <button id="project-upload" type="button" class="btn btn-primary">Publish Sample</button>
            </div>
            <div id="result-project">
                <h6></h6>
            </div>

        </form>

    </div>
    <hr>
    <div class="col-lg-8">
        <h3>Submitted Projects</h3>
        <br>
        <table class="table table-striped">

            <thead>
                <tr>
                    <td>Project Name</td>

                    <td>Status</td>
                    <td>
                        <button type="button">Pending</button></td>
                    <td><button type="button">Active</button></td>
                    <td><button type="button">Accept</button></td>
                    <td><button type="button">Reject</button></td>
                    <td><button type="button">Under Dev</button></td>
                    <td><button type="button">Completed</button></td>
                    <td><button type="button">Download</button></td>
                </tr>

            </thead>
            <tbody></tbody>


        </table>

    </div>
</div>

<script>
    $("#project-upload").click(function() {

        var validFormat = ["application/pdf"];

        $("#project-name").removeClass("is-invalid");
        $("#project-file").removeClass("is-invalid");

        var title = $("#project-name").val();
        var file = $("#project-file").prop("files")[0];


        if (!title) {
            $("#project-name").addClass("is-invalid");
            return;
        }
        if (file == null) {
            $("project-file").addClass("is-invalid");
            return;
        }
        if ($.inArray(file["type"], validFormat) < 0) {
            $("#project-file").addClass("is-invalid");
            return;
        }

        $("#spinner").addClass("spinner-grow")
        var time = new Date().getTime();

        var database = firebase.database().ref("Projects/sample");

        var name = file["name"];
        var extension = name.substring(name.lastIndexOf("."), name.length);


        var storage = firebase.storage().ref("Projects" + "/" + "sample" + extension);
        var uploadTask = storage.put(file);

        uploadTask.on("state_changed",
            function progress(snapshot) {

                var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                $("#project-progress").html(percentage + "%");
                $("#project-progress").attr("style", "width:" + percentage + "%");


            },
            function error(err) {

            },

            function complete() {

                uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {

                    database.set(downloadURL, function(err) {
                        if (err) {
                            $("#result-project").attr("class", "alert alert-danger");
                            $("#result-project").html(err.message);

                        } else {
                            $("#result-project").attr("class", "alert alert-success");
                            $("#result-project").html("Sample Posted Successfully");


                        }
                        $("#spinner").removeClass("spinner-grow")
                        $("#project")[0].reset();
                        $("#project-progress").html("Completed");
                    })

                });
            });
    })
</script>